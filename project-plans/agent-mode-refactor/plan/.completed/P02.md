# Phase 02: Expose Tool Events - Evidence

## Date: 2025-01-28

## Changes Made

1. Added `ToolCallStarted` and `ToolCallCompleted` variants to `StreamEvent` enum in `src/llm/client.rs`
2. Updated `run_agent_stream` in `src/llm/client_agent.rs` to emit these events (instead of just eprintln)
3. Updated `src/ui/chat_view_helpers/streaming.rs` to handle new event variants

## Verification Results

### Check 1: ToolCallStarted/Completed in client_agent.rs (emit, not eprintln)
```bash
$ grep -n "ToolCallStarted\|ToolCallCompleted" src/llm/client_agent.rs
169:                        on_event(StreamEvent::ToolCallStarted {
182:                        on_event(StreamEvent::ToolCallCompleted {
```
Result: PASS (events are emitted via on_event callback)

### Check 2: No more eprintln for tool events
```bash
$ grep -n "eprintln.*Tool" src/llm/client_agent.rs
(no output)
```
Result: PASS (debug prints removed)

### Check 3: StreamEvent has new variants
```bash
$ grep -n "ToolCallStarted\|ToolCallCompleted" src/llm/client.rs
28:    ToolCallStarted {
36:    ToolCallCompleted {
```
Result: PASS

### Check 4: Build passes
```bash
$ cargo build --all-targets 2>&1 | tail -3
    Finished `dev` profile [unoptimized + debuginfo] target(s) in 8.75s
```
Result: PASS

### Check 5: Chat service tests pass
```bash
$ cargo test --lib services::chat 2>&1 | tail -3
test result: ok. 11 passed; 0 failed; 0 ignored; 0 measured; 175 filtered out; finished in 0.00s
```
Result: PASS

## Summary

Tool events are now properly emitted during agent streaming:
- `StreamEvent::ToolCallStarted { tool_name, call_id }` - when agent starts a tool call
- `StreamEvent::ToolCallCompleted { tool_name, call_id, success, result, error }` - when tool finishes

The UI streaming helper also handles these events (logs them for now).

## Note on Other Test Failures

54 tests in services::mcp and services::mcp_registry fail - these are pre-existing failures
related to unimplemented stubs in those modules (NOT related to this phase's changes).
The relevant chat tests all pass.

## Verdict

**PASS**
